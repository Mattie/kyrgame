id: 20
name: ruby cache
# Legacy: legacy/KYRROUS.C lines 600-617 (rubies) picks a ruby with 20% success and snake backlash otherwise.
triggers:
  - verbs: [get, grab, pick, take]
    target_in: [ruby]
    actions:
      - type: random_chance
        probability: 0.2
        on_success:
          - type: conditional
            conditions:
              - inventory_lt: 6
            then:
              - type: grant_object
                object: ruby
              - type: message
                scope: direct
                message_id: RUBY00
              - type: message
                scope: broadcast
                message_id: RUBY01
                format: [player_id]
            else:
              - type: message
                scope: direct
                message_id: RUBY02
              - type: message
                scope: broadcast
                message_id: RUBY03
                format: [player_id]
              - type: damage
                amount: 8
        on_failure:
          - type: message
            scope: direct
            message_id: RUBY02
          - type: message
            scope: broadcast
            message_id: RUBY03
            format: [player_id]
          - type: damage
            amount: 8
