id: 27
name: swrock
spoiler_summary: "Strange rock shrouded in mist that responds to prayers and a sword offering."
spoiler_interaction: "Pray at the rock to stir the mists, then drop a sword onto the rock (\"sword rock\") to trade it for a tiara; failing to have the sword is rejected."
legacy_ref: "legacy/KYRROUS.C:679-705"
state:
  rockpr: 0
triggers:
  - verbs: [pray]
    actions:
      - type: message
        scope: direct
        text: "...Your prayers are heard."
      - type: message
        scope: broadcast
        text: "*** The mists around the rock begin to swirl magically!"
      - type: increment_room_state
        key: rockpr
  - verbs: [drop, insert, put, stick, thrust]
    arg_sequence: [sword, rock]
    room_state_at_least:
      rockpr: 1
    actions:
      - type: conditional
        conditions:
          - has_item: sword
        then:
          - type: remove_item
            item: sword
          - type: add_room_object
            object: tiara
          - type: message
            scope: direct
            message_id: ROCK00
          - type: message
            scope: broadcast
            message_id: ROCK01
            format: [player_id]
        else:
          - type: message
            scope: direct
            message_id: ROCK02
          - type: message
            scope: broadcast
            message_id: ROCK01
            format: [player_id]
